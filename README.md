# pi_arr

[![Crate](https://img.shields.io/crates/v/pi_arr?style=for-the-badge)](https://crates.io/crates/pi_arr)
[![Github](https://img.shields.io/badge/github-pi_arr-success?style=for-the-badge)](https://github.com/GaiaWorld/pi_arr)
[![Docs](https://img.shields.io/badge/docs.rs-0.2.2-4d76ae?style=for-the-badge)](https://docs.rs/pi_arr)


# pi_arr - é«˜æ€§èƒ½è‡ªåŠ¨æ‰©å±•æ•°ç»„åº“

æœ¬åº“æä¾›äº†ä¸¤ç§è‡ªåŠ¨æ‰©å±•çš„æ•°ç»„å®ç°ï¼Œé’ˆå¯¹ä¸åŒç¯å¢ƒä¼˜åŒ–ï¼š

## ç»“æ„ä½“

### `VBArr` (åŸºäºæ¡¶çš„æ‰©å±•æ•°ç»„)
- **è®¾è®¡ç›®æ ‡**ï¼šå¤šçº¿ç¨‹ç¯å¢ƒä½¿ç”¨
- **æ ¸å¿ƒæœºåˆ¶**ï¼šä¸»æ•°ç»„(å¯æ‰©å±•Vec) + è¾…åŠ©æ•°ç»„(å›ºå®šå¤§å°æ¡¶)
- **æ‰©å±•æ–¹å¼**ï¼šä¸»æ•°ç»„æ»¡æ—¶ï¼Œçº¿ç¨‹å®‰å…¨åœ°åœ¨è¾…åŠ©æ¡¶åˆ†é…æ–°æ•°ç»„
- **å†…å­˜æ•´ç†**ï¼šæ”¯æŒ`settle()`åˆå¹¶æ‰€æœ‰æ•°æ®åˆ°ä¸»æ•°ç»„
- **çº¿ç¨‹å®‰å…¨**ï¼šéœ€å¤–éƒ¨ä¿è¯ä¸ä¼šåŒæ—¶è®¿é—®åŒä¸€å…ƒç´ 

### `VecArr` (åŸºäºVecçš„æ‰©å±•æ•°ç»„)
- **è®¾è®¡ç›®æ ‡**ï¼šWASMç¯å¢ƒä¸“ç”¨
- **æ ¸å¿ƒæœºåˆ¶**ï¼šå•ä¸ªè‡ªåŠ¨æ‰©å±•çš„Vec
- **ç‰¹ç‚¹**ï¼šå®ç°ç®€å•ï¼Œæ— æ¡¶ç»“æ„
- **çº¿ç¨‹å®‰å…¨**ï¼šéçº¿ç¨‹å®‰å…¨å®ç°


## ç‰¹æ€§

### æ ¸å¿ƒèƒ½åŠ›
âœ… **é›¶æ‹·è´è®¿é—®** - ç›´æ¥æŒ‡é’ˆæ“ä½œé¿å…å†…å­˜æ‹·è´  
âœ… **ZSTæ”¯æŒ** - å®Œç¾å¤„ç†é›¶å¤§å°ç±»å‹  
ğŸ”§ **å†…å­˜æ•´ç†** - `settle()` æ•´åˆåˆ†æ¡¶æ•°æ®åˆ°ä¸»æ•°ç»„  
ğŸ”’ **ç»†ç²’åº¦é”** - åˆ†æ¡¶åˆå§‹åŒ–ä½¿ç”¨è½»é‡çº§é”  

## æ€§èƒ½æŒ‡æ ‡

### å®¹é‡é™åˆ¶
| ç±»å‹       | æœ€å¤§å…ƒç´ æ•°          | å†…å­˜å ç”¨          |
|-----------|-------------------|-----------------|
| VecArr    | usize::MAX        | O(n)           |
| VBArr     | 2^32 - 32 â‰ˆ42.9äº¿ | O(n)   |

### æ“ä½œè€—æ—¶ï¼ˆå‚è€ƒå€¼ï¼‰
| æ“ä½œ       | VecArr  | VBArr   |
|-----------|--------|--------|
| éšæœºè¯»å–    | 1-3 ns | 5-8 ns |
| é¡ºåºè¿­ä»£    | 2ns/å…ƒç´ | 5-15ns/å…ƒç´ |
| æ‰©å®¹æ“ä½œ    | O(n)   | O(1)   |

## å¿«é€Ÿå…¥é—¨

### å®‰è£…
```toml
[dependencies]
pi_arr = "0.30"
```

## ä¸»è¦æ–¹æ³•

### é€šç”¨æ–¹æ³•
- `with_capacity(capacity: usize) -> Self`  
  åˆ›å»ºæŒ‡å®šåˆå§‹å®¹é‡çš„æ•°ç»„
  
- `capacity(len: usize) -> usize`  
  è®¡ç®—ç»™å®šå…ƒç´ æ•°é‡æ‰€éœ€çš„æ€»å®¹é‡
  
- `vec_capacity() -> usize`  
  è·å–ä¸»æ•°ç»„çš„å®¹é‡(å…ƒç´ æ•°é‡)
  
- `get(index: usize) -> Option<&T>`  
  å®‰å…¨è·å–å…ƒç´ å¼•ç”¨(è¾¹ç•Œæ£€æŸ¥)
  
- `get_mut(index: usize) -> Option<&mut T>`  
  è·å–å¯å˜å…ƒç´ å¼•ç”¨
  
- `set(index: usize, value: T) -> T`  
  è®¾ç½®å…ƒç´ å€¼å¹¶è¿”å›æ—§å€¼
  
- `insert(index: usize, value: T) -> T`  
  åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ 
  
- `slice(range: Range<usize>) -> Iter`  
  è·å–æŒ‡å®šèŒƒå›´çš„è¿­ä»£å™¨
  
- `settle(len: usize, additional: usize)`  
  å†…å­˜æ•´ç†(åˆå¹¶æ•°æ®åˆ°ä¸»æ•°ç»„)
  
- `clear(len: usize, additional: usize)`  
  æ¸…ç†æ•°æ®å¹¶é‡Šæ”¾å†…å­˜

- `alloc(index: usize) -> &mut T`  
è·å–æˆ–åˆ†é…å…ƒç´ (è‡ªåŠ¨åˆå§‹åŒ–)

- `load(index: usize) -> Option<&mut T>`  
å®‰å…¨åŠ è½½å…ƒç´ (ä¸è‡ªåŠ¨åˆ†é…)

- `load_alloc(index: usize) -> &mut T`  
åŠ è½½æˆ–åˆ†é…å…ƒç´ (è‡ªåŠ¨åˆå§‹åŒ–)

## ç±»å‹åˆ«å
- `Arr<T>`: æ ¹æ®ç‰¹æ€§é€‰æ‹©å®ç°
  - å¯ç”¨ "rc" ç‰¹æ€§ï¼š`VecArr<T>`
  - æœªå¯ç”¨ï¼š`VBArr<T>`
- `Iter<'a, T>`: å¯¹åº”çš„è¿­ä»£å™¨ç±»å‹

## å®
- `arr![]`: å¿«é€Ÿåˆ›å»ºæ•°ç»„
  ```rust
  let a = arr![1, 2, 3];      // åˆ›å»ºåŒ…å«å…ƒç´ çš„æ•°ç»„
  let b = arr![0; 5];         // åˆ›å»º5ä¸ª0çš„æ•°ç»„
  ```

## ç¤ºä¾‹ä»£ç 

```rust
use pi_arr::{Arr, arr};

fn main() {
    // åˆ›å»ºä¸€ä¸ªåŒ…å«å…ƒç´ çš„æ•°ç»„
    let mut a = arr![1, 2, 3];
    // æ’å…¥å…ƒç´ 
    a.insert(1, 4);
    // è·å–å…ƒç´ å¼•ç”¨
    let x = a.get(1).unwrap();
    println!("x: {}", x);
    // è®¾ç½®å…ƒç´ å€¼
    a.set(1, 5);
    // è·å–å¯å˜å…ƒç´ å¼•ç”¨
    let mut y = a.get_mut(1).unwrap();
    *y = 6;
    println!("y: {}", y);
}
```

## è´¡çŒ®

æ¬¢è¿æäº¤Pull Requestæˆ–Issueæ¥è´¡çŒ®ä»£ç æˆ–æŠ¥å‘Šé—®é¢˜ã€‚
